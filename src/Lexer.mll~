{
  open Parser
  open Lexing
  let incr_lineno lexbuf =
    let pos = lexbuf.lex_curr_p in
    lexbuf.lex_curr_p <- { pos with
      pos_lnum = pos.pos_lnum + 1;
      pos_bol = pos.pos_cnum;
    }
}
let digit = ['0'-'9']
let lowercase = ['a'-'z']
let uppercase = ['A'-'Z']
let ident_body = lowercase | uppercase | digit | '_'
rule token = parse
  | [' ' '\t']	{ token lexbuf }
  | '\n'	{ incr_lineno lexbuf; token lexbuf }
  | digit+ as num
		{ NUM (int_of_string num) }
  | '+'		{ PLUS }
  | '*'		{ MULTIPLY }
  | '('		{ LPAREN }
  | ')'		{ RPAREN }
  | '='		{ EQUAL }
  | ','		{ COMMA }
  | ':'		{ COLON }
  | "function"  { FUNCTION }
  | "fun"       { FUN }
  | "match"     { MATCH }
  | "with"      { WITH }
  | "nat"       { NAT }
  | "type"      { TYPE }
  | "<="        { LESSEQUAL }
  | "=="        { EQUALEQUAL }
  | ';'         { SEMICOLON }
  | "false"     { FALSE }
  | "&&"        { AMPERSAND }
  | "for"       { FOR }
  | "all"       { ALL }
  | "newcons"   { NEWCONS }
  | "newtype"   { NEWTYPE }
  | "external"  { EXTERNAL }
  | "-->"       { MINUSMINUSGREATER }
  | '_'		{ UNDERSCORE }
  | '|'		{ BAR }
  | '!'		{ EXCLAMATION }
  | "let"       { LET }
  | "rec"       { REC }
  | "and"       { AND }
  | "in"        { IN }
  | "as"        { AS }
  | "->"        { MINUSGREATER }
  | (lowercase ident_body*) as id
      { LIDENT id }
  | (uppercase ident_body*) as id
      { UIDENT id }
  | eof		{ EOF }
